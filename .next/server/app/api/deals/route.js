"use strict";(()=>{var e={};e.id=696,e.ids=[696],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3590:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>s});var a={};t.r(a),t.d(a,{GET:()=>p});var i=t(1569),n=t(5482),d=t(7807),o=t(314),c=t(9286);async function p(e){let{searchParams:r}=e.nextUrl,t=Number(r.get("minSpread")||0),a=r.get("world"),i=r.get("category"),n=r.get("grade"),d=function(){let e=[];for(let r of c._u){let t=c.Hj.filter(e=>e.cardId===r.id);if(t.length<2)continue;let a=[...t].sort((e,r)=>e.price-r.price),i=a[0],n=a[a.length-1],d=(n.price-i.price)/i.price*100,o=Math.round(t.reduce((e,r)=>e+r.liquidity,0)/t.length);e.push({cardId:r.id,card:r,cheapestMarket:i.marketplace,cheapestPrice:i.price,expensiveMarket:n.marketplace,expensivePrice:n.price,spreadPercent:Math.round(10*d)/10,liquidityScore:o,confidenceScore:function(e){if(e.length<2)return 0;let r=e.map(e=>e.price),t=e.reduce((e,r)=>e+r.liquidity,0)/e.length,a=r.reduce((e,r)=>e+r,0)/r.length,i=function(e){let r=e.reduce((e,r)=>e+r,0)/e.length;return Math.sqrt(e.map(e=>(e-r)**2).reduce((e,r)=>e+r,0)/e.length)}(r)/a,n=.5*t;return n+=Math.max(0,30-100*i)+Math.min(5*e.length,20),i>.15&&(n-=(i-.15)*80),Math.round(Math.max(0,Math.min(100,n)))}(t)})}return e.sort((e,r)=>r.spreadPercent-e.spreadPercent)}();return t>0&&(d=d.filter(e=>e.spreadPercent>=t)),a&&(d=d.filter(e=>e.card.world===a)),i&&(d=d.filter(e=>e.card.category===i)),n&&(d=d.filter(e=>e.card.grade===n)),o.NextResponse.json(d)}let u=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/deals/route",pathname:"/api/deals",filename:"route",bundlePath:"app/api/deals/route"},resolvedPagePath:"/data/workspace/moltbot-marketworld/app/api/deals/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:s,serverHooks:h}=u,g="/api/deals/route";function m(){return(0,d.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:s})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[33,514,286],()=>t(3590));module.exports=a})();